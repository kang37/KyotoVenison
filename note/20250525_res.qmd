---
title: "统计报告"
author: "康"
format: html
editor: visual
editor_options: 
  chunk_output_type: console
---

## 1 简介

主要包含3方面内容：统计分析，看各种属性、吃肉态度、狩猎态度之间的关系；主题分析，看关于吃肉的谈论中主要包含什么主题，不同吃肉态度的人更倾向于什么主题；情感分析，看不同吃肉态度的受访者是更消极还是更积极。**但是情感分析有点逻辑问题，需要再讨论。**

原始数据处理方面，仅保留符合以下条件的数据：有吃肉态度打分，有狩猎态度打分，回答了吃肉开放问题，有有效性别数据，有有效年龄数据。并且，将非日语文本回答改成日语，且将回答文本中一些假名换成汉字。

## 2 统计分析

这部分主要进行数字型变量之间的统计分析，尤其是性别/年龄/教育水平等属性、对吃鹿肉的态度打分（以下简称"鹿肉态度"）、对狩猎的态度的打分（以下简称"狩猎态度"）3者之间的关系。

### 2.1 鹿肉态度～属性

吃鹿肉态度～性别：朱珠已进行了卡方分析，此处基于每个受访者数据进行组间对比。首先用shapiro test检验要对比的各组内数据是否为正态分布，如果p \< 0.05，则不属于正态分布。可见无论是男性组（gender = 0，p-value \< 2.2e-16）还是女性组（gender = 1，p-value = 4.186e-15），检测结果均显著，也就是说两者都不是正态分布。

```{r}
by(as.numeric(survey$ven), survey$gender, shapiro.test)
# 男女组均不符合正态分布，因此用非参数方法进行组间对比。
```

因此，用非参数方法Kruskal-Wallis rank sum test进行对比。对比结果（p-value = 0.003228）表明男女组的鹿肉态度有差异。进一步计算两组的平均数和中位数，表明男性鹿肉态度更高。

```{r}
kruskal.test(as.numeric(survey$ven) ~ survey$gender)
survey %>% 
  group_by(gender) %>% 
  summarise(
    ven_mean = mean(as.numeric(ven)), 
    ven_mid = median(as.numeric(ven)), .groups = "drop"
  )
```

吃鹿肉态度～年龄组：大部分年龄组不符合正态分布，因此用非参数方法。结果表明不同年龄组之间无显著差异。

```{r}
by(as.numeric(survey$ven), survey$age, shapiro.test)
kruskal.test(as.numeric(survey$ven) ~ survey$age)
```

吃鹿肉态度～教育水平：无显著差异。

```{r}
lapply(
  as.character(1:4), 
  function(x) {
    filter(survey, education == x)$ven %>% 
      as.numeric() %>% 
      shapiro.test()
  }
)
kruskal.test(as.numeric(survey$ven) ~ survey$education)
```

### 2.2 狩猎态度～属性

狩猎态度～性别：男女有显著差异（p-value = 4.156e-08）。

狩猎态度～年龄组：不同年龄有显著差异。总体而言，年龄大点儿的受访者态度更高。如果需要的话，可以做两两对比分析。

狩猎态度～教育水平：无显著差异。

```{r}
# 狩猎态度～性别。
by(as.numeric(survey$hunting), survey$gender, shapiro.test)
kruskal.test(as.numeric(survey$hunting) ~ survey$gender)

# 狩猎态度～年龄组。
by(as.numeric(survey$hunting), survey$age, shapiro.test)
kruskal.test(as.numeric(survey$hunting) ~ survey$age)
survey %>% 
  group_by(age) %>% 
  summarise(
    ven_mean = mean(as.numeric(hunting)), 
    ven_mid = median(as.numeric(hunting)), 
    .groups = "drop"
  )

# 狩猎态度～教育水平。
lapply(
  as.character(1:4), 
  function(x) {
    filter(survey, education == x)$hunting %>% 
      as.numeric() %>% 
      shapiro.test()
  }
)
kruskal.test(as.numeric(survey$hunting) ~ survey$education)
```

### 2.3 鹿肉态度～狩猎态度

Pearson相关性和Spearman相关性分析都表明，两者显著正相关。不过通常计算一种相关系数就够了。

```{r}
cor.test(as.numeric(survey$ven), as.numeric(survey$hunting), method = "pearson")
cor.test(as.numeric(survey$ven), as.numeric(survey$hunting), method = "spearman")
```

## 3 主题分析

具体方法参见之前的报告。在更新后的结果中，文本被分成8个主题。这8个主题的高频关键词是：

```{r}
library(knitr)
library(kableExtra)
tidy(quan_lda, matrix = "beta") %>% 
  group_by(topic) %>% 
  slice_max(beta, n = 15) %>% 
  mutate(term = reorder_within(term, beta, topic)) %>% 
  summarise(term = list(term), .groups = "drop") %>% 
  mutate(
    term = unlist(lapply(term, function(x) paste0(x, collapse = ", ")))
  ) %>% 
  mutate(term = gsub("_", "", term), term = gsub("[0-9]", "", term)) %>% 
  kable() %>% 
  kable_styling()
```

各主题的典型文本如下：

```{r}
quan_id_topic %>% 
  group_by(topic) %>% 
  arrange(topic, -gamma) %>% 
  slice_head(n = 10) %>% 
  ungroup() %>% 
  # 漏洞：需要提前更改id的类型。
  left_join(mutate(survey, id = as.character(id)), by = "id") %>% 
  select(id, topic, ven_reason) %>% 
  kable() %>% 
  kable_styling()
```

ChatGPT解读：对于每个主题，将各文本放进GPT，并且询问\"请总结下面这些言论的主题，请将回答限制在200字以内：\[空一行接上排名前10位的典型文本\]\"。例如，如果要知道主题1的含义，就输入以下信息：

```         
请总结下面这些言论的主题，请将回答限制在200字以内：

数十年前にはコース料理でジビエがあれ牛肉に偏向してもらっていた。今後懸念される食糧危機対策になる可能性がある
生命を奪う代わりに、すべての部位を余すことなく料理し、生命に感謝を捧げる。
料理方法にもよります。生でしたら、挑戦したくないです。
食べるのは抵抗はないが牛肉・豚肉・鶏肉程食べないかも
ジビエについて詳しく知らない
大人になって急に食べてくださいといわれても無理
鹿が増えすぎ駆除だけされるなら、みんなにも食してもらい現状を知ってもらうべきだ。牛肉、とり、豚だけなく自然の中にあるお肉を食べるのともっと身近になるのは、良いかと思う。ユーロッパなどはジビエを食べるけど、日本人は、身近でない気がする。飲食店と協力してジビエをもっとしゅうちして身近なものに。
食肉にすることが行き過ぎた目標になるのは良いと思えないが、生命が同じ地に生きるなら「いただく」というのも共存のための一つの選択かも知れない
ジビエ料理といっても牛、ぶた、鶏と違って慣れていない、家畜として飼えない
伝統料理として広まっているから
```

得到的回答如下。

**主题1：**这些言论主要涉及以下几个主题：对野生动物食用（如鹿肉、野猪肉）的态度和看法；对于未来食物短缺的担忧以及将野生动物作为食物资源的潜力；对生命的尊重与感恩，主张合理利用所有部位；烹饪方式对食用意愿的影响；地域文化和个人习惯对食用野生动物的影响；以及通过宣传和餐饮业合作，使野生动物食材变得更加普及和被接受。总的来说，这些言论反映了对野生动物资源利用的多维度思考，包括环保、文化、经济和实际操作等方面。

**主题2：**这些言论主要围绕以下几个主题展开：将鹿肉视为与牛肉、猪肉、鸡肉等同等的食材；对未来食物短缺问题的担忧，认为应充分利用可食用资源；对鹿数量过多带来的环境和自身生活的影响表示关注，主张通过食用解决；认为日本人对食物资源的浪费应引起重视；强调鹿肉与其他常见肉类一样，应被合理利用。总的来说，这些言论反映了对鹿肉作为食物资源的接受与支持，以及对可持续资源利用和环境保护的思考。

**主题3：**这些言论主要围绕以下几个主题展开：鹿肉营养丰富但购买不便，希望更易获取；处理鹿肉涉及费用和精力，通过食物流通和宣传提高公众意识；反对滥杀，但在必要时应充分利用其资源；认为减少鹿的数量是应对其负面影响的有效方法；将鹿肉视为天然资源的合理利用；有养狗家庭使用鹿肉作为宠物食物；强调在不得已的情况下捕杀鹿后应充分利用其肉；对鹿肉可能携带疾病的担忧。总体反映了对鹿肉资源的合理利用和环境保护的思考。

**主题4：**这些言论主要围绕以下几个主题展开：对过多鹿群的管理与利用，包括将其制成宠物或动物园肉食动物的食物；认为应在适当范围内捕猎并利用以获取资金；强调过度捕杀不道德，应寻求替代方法如使用野生肉以减少畜牧业的环境负担；支持通过食用来控制鹿群数量，并认为这有助于自然保护和丰富食文化；强调活用资源的重要性，但反对无意义的杀生。总体反映了对合理管理与利用鹿群资源的多角度思考。

**主题5：**这些言论主要围绕以下几个主题展开：希望鹿能够在野生环境中生活，担心人类破坏自然导致生态失衡；担忧过度食用鹿肉可能对其他野生动物造成威胁，尤其是在市区附近活动的鹿；认为鹿群过多的根本原因在于人类行为，应从根本上改善环境；对鹿肉利用持矛盾态度，一方面认为避免浪费是好的，另一方面认为这是人类的自私行为；强调应保护鹿的自然生活，尽量避免将其食用；同时，也有观点认为将鹿肉用于食用可以有效控制鹿群数量。

**主题6：**这些言论的主要主题是关于合理利用被捕杀的鹿肉。许多人认为，与其随意捕杀，不如将鹿肉用于食用或者提供给动物园，这样既可以尊重鹿的生命，也有助于人类的生存和生态平衡。一些人提到鹿肉作为食材的优点，如高蛋白低脂肪，同时认为将其用于食用能减少捕杀的成本，促进生态系统的健康。有些人表达了道德上的担忧，认为如果要捕杀鹿，至少应将其资源有效利用，以示对生命的尊重。总的来说，观点集中在如何更负责任地处理过多的鹿群问题。

**主题7：**这些言论的主要主题是关于通过合理利用被捕杀的鹿肉来促进生态保护和地方经济发展。许多人认为，如果能够解决寄生虫和病毒等问题，利用鹿肉不仅可以减少废弃物，还能激发年轻人从事狩猎，促进社区活力。此外，合理利用鹿肉可以减少捕杀成本，同时让捕杀的鹿得到更有意义的处理。一些人认为，尽管乱猎不可取，但适当控制鹿群数量并有效利用其资源是更好的选择，因为这体现了对生命的尊重和有效资源管理的理念。

**主题8：**这些言论的主要主题是关于人们对食用鹿肉的不同看法。大多数人表示他们没有食用鹿肉的欲望，认为它不吸引人或不符合现代饮食习惯。一些人提到曾经尝试过鹿肉但觉得不美味。然而，也有少数人认为鹿肉有潜在的健康益处，并且利用鹿肉可以解决某些问题，如资源的有效利用和鹿皮的应用。一些人提到过去对鹿皮制品的正面记忆，但整体上对鹿肉的兴趣较低。

**当然这些含义总结有点长，所以考虑减少字数。**

## 4 情感分析

所谓\"情感分析（sentiment analysis）\"，根据我一个做文本分析程序开发的朋友的说法，并不是很严格的概念，尤其是只把情绪分成\"积极\"和\"消极\"的时候：因为情感是很多维度的概念。相比于\"情感分析\"，说\"极性\"可能更加合理，比如说在\"开心不开心\"的维度上，可以将文本分到开心的和不开心的两端（以及它们中间的不那么开心的、中性的等等）。但是遵循传统，我们此处沿用\"情感分析\"一词。

在这个情感分析中，我们使用LSS（Latent Semantic Scaling）方法：（1）选择一系列积极的种子词汇和消极的种子词汇，这些词汇将构成我们的\"积极-消极情绪空间\"的坐标；（2）简单来说，衡量其他词汇和这些积极/消极词汇的距离，和积极词汇的距离越近，词语的得分也就越正面；（3）文本的积极或消极就取决于所含词汇在这个情绪空间中的位置。

我选择的5个积极种子词汇是："恵み"，"絶賛"，"良い"，"美味しい"，"活用"；而消极种子词汇是"破壊"，"危険"，"心配"，"被害"，"怖い"。在这个情绪空间内，其他词汇的得分和词汇频率如下图。

```{r}
textplot_terms(lss, highlighted = names(topfeatures(quan_dtm, n = 15)))
```

得分最高（积极）的词汇和最低的词汇如下：

```{r}
head(coef(lss), 20)
tail(coef(lss), 20)
```

可以看出不同吃肉态度的人的情绪得分：

```{r}
ggplot(lss_score, aes(ven, fit)) + 
  geom_boxplot() + 
  geom_jitter(alpha = 0.2)
```

但是上图有个逻辑问题：通常来说对吃肉态度较低的人就是比较消极的，而对吃肉比较能接受的人就是发言比较积极，所以我不确定这个分析是否有意义。当然，也可以说这是从定量的角度佐证了受访者们的吃肉态度打分和他们的回答文本是一致的。

需要再考虑一下这个问题。比如说，能否看看其他变量和情绪得分之间的关系？
